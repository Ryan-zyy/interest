(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[978],{22241:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return Z}});var n=r(92809),a=r(30266),c=r(11187),s=r(28465),i=r(97538),o=r(80318),l=r(809),u=r.n(l),d=r(50237),f=r(67294),p=r(93565),h=r(43347),m=r(28485),g=function(e){return new Promise((function(t,r){var n=new Image;n.src=e,n.onload=function(e){if(e.path&&e.path.length){var a=e.path[0],c=a.width,s=a.height;t([c,s,n])}else r()},n.onerror=r}))},v=function(e){for(var t=[],r=0;r<e.length;r+=4)t.push([e[r],e[r+1],e[r+2],e[r+3]]);return t},b=function(){var e=(0,a.Z)(u().mark((function e(t){var r,n,a,c,s,i,l,d;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(t);case 2:return r=e.sent,n=(0,o.Z)(r,3),a=n[0],c=n[1],s=n[2],i=document.createElement("canvas"),l=[a,c],i.width=l[0],i.height=l[1],(d=i.getContext("2d")).drawImage(s,0,0),e.abrupt("return",[v(d.getImageData(0,0,a,c).data),a,c]);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(e){return new Promise((function(t,r){m.clusterize(e,{k:4},(function(e,n){e&&r(e),t(n)}))}))},j=r(94184),x=r.n(j),_=r(85893);function N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?N(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var O=[{val:"\u8bc1\u4ef6\u7167\u6362\u5e95\u8272\u3002"},{val:"* \u57fa\u4e8e k-means \u7b97\u6cd5\u3002"},{val:"* \u7eaf\u5728\u7ebf\u8f6c\u6362\uff0c\u65e0\u9700\u4e0a\u4f20\u81f3\u540e\u53f0\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528\u3002"}];function Z(e){var t=i.Z.useForm(),r=(0,o.Z)(t,1)[0],n=s.Z.Dragger,l=(0,f.useState)(""),m=l[0],g=l[1],v=(0,f.useState)(""),j=v[0],N=v[1],Z=(0,f.useState)(!1),y=Z[0],P=Z[1],E=(0,f.useRef)({}),I=(0,f.useRef)([]),C={name:"file",maxCount:1,showUploadList:!1,onChange:function(e){var t=e.file,r=t.status;if("done"===r){var n=window.URL.createObjectURL(t.originFileObj);g(n)}else"error"===r&&c.default.error("".concat(t.name," file upload failed."))},customRequest:function(e){e.onSuccess()}},D=(0,f.useCallback)((0,a.Z)(u().mark((function e(){var t,n,a,s,i,l,d;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!m){e.next=18;break}return P(!0),e.next=5,b(m);case 5:return t=e.sent,n=(0,o.Z)(t,3),a=n[0],s=n[1],i=n[2],E.current={imageData:a,width:s,height:i},e.next=13,w(a);case 13:l=e.sent,d=l.find((function(e){return e.clusterInd.includes(0)})),r.setFieldsValue({color:{r:~~d.centroid[0],g:~~d.centroid[1],b:~~d.centroid[2],a:(d.centroid[3]/255).toFixed(2)}}),I.current=d,P(!1);case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),c.default.error(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])}))),[m]);return(0,f.useEffect)((function(){D()}),[D]),(0,_.jsx)(d.Z,k(k({className:"interest-replace-background",title:"Replace Background",description:O},e),{},{children:(0,_.jsx)("div",{className:"interest-replace-background__content",children:(0,_.jsxs)(i.Z,k(k({name:"basic",form:r,initialValues:{},onValuesChange:function(e){try{if(e.color){P(!0);var t=e.color.rgb,r=t.r,n=t.g,a=t.b,s=t.a,i=E.current,o=i.imageData,l=i.width,u=i.height;I.current.clusterInd.forEach((function(e){o[e]=[~~r,~~n,~~a,~~(255*s)]})),N(function(e,t,r){e=e.flat(1);var n=document.createElement("canvas"),a=[t,r];n.width=a[0],n.height=a[1];var c=n.getContext("2d"),s=c.createImageData(t,r);return s.data.set?s.data.set(e):e.forEach((function(e,t){s.data[t]=e})),c.putImageData(s,0,0),n.toDataURL()}(o,l,u)),P(!1)}}catch(d){c.default.error(d)}}},{labelCol:{span:3},wrapperCol:{span:21,offset:0},labelAlign:"left"}),{},{children:[(0,_.jsx)(i.Z.Item,{label:"\u9009\u62e9\u8bc1\u4ef6\u7167",name:"file",valuePropName:"file",getValueFromEvent:function(e){return e&&e.file},rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u8bc1\u4ef6\u7167"}],children:m?(0,_.jsx)("img",{src:m,className:"interest-replace-background__preview",alt:"\u9009\u62e9\u8bc1\u4ef6\u7167"}):(0,_.jsxs)(n,k(k({},C),{},{children:[(0,_.jsx)("p",{className:"ant-upload-drag-icon",children:(0,_.jsx)(h.Z,{})}),(0,_.jsx)("p",{className:"ant-upload-text",children:"\u70b9\u51fb\u6216\u62d6\u62fd\u6587\u4ef6\u81f3\u6b64\u533a\u57df"})]}))}),m&&(0,_.jsx)(i.Z.Item,{label:"\u9009\u62e9\u5e95\u8272",name:"color",valuePropName:"color",children:(0,_.jsx)(p.Ie,{})}),j&&(0,_.jsx)(i.Z.Item,{label:"\u9884\u89c8",children:(0,_.jsx)("div",{className:x()("interest-replace-background__preview-wrapper",{"interest-replace-background__preview-wrapper--loading":y}),children:(0,_.jsx)("img",{src:j,className:"interest-replace-background__preview",alt:"\u8bc1\u4ef6\u7167\u9884\u89c8"})})})]}))})}))}},50237:function(e,t,r){"use strict";var n=r(74806),a=r(89552),c=r(94184),s=r.n(c),i=r(67294),o=r(85893);function l(e,t){var r=e.children,c=e.className,l=e.title,u=e.description,d=e.isNarrow,f=(0,i.useState)(0),p=f[0],h=f[1],m=function(e){h(e)};return(0,i.useImperativeHandle)(t,(function(){return{handleProcess:m}})),(0,o.jsxs)("div",{className:s()("app-content",{"app-content--narrow":d},c),ref:t,children:[l&&(0,o.jsx)("h1",{className:"app-content__title",children:l}),(0,o.jsx)("ul",{className:"app-content__description",children:u&&u.length&&u.map((function(e,t){var r=e.val,n=e.style;return(0,o.jsx)("li",{style:n,className:"app-content__description-item",children:r},t)}))}),r,(0,o.jsxs)("div",{className:s()("interest-loading","interest-content-loading",{"interest-loading--hide":0===p||p>=100}),children:[(0,o.jsx)(a.Z,{}),(0,o.jsx)(n.default,{strokeColor:{"0%":"#108ee9","100%":"#87d068"},percent:p,className:"interest-loading__progress"})]})]})}t.Z=(0,i.forwardRef)(l)},73561:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/example/replace-background",function(){return r(22241)}])}},function(e){e.O(0,[774,676,806,552,400,829,703,373,888,179],(function(){return t=73561,e(e.s=t);var t}));var t=e.O();_N_E=t}]);